/* Simplify Mode Styles */
/* Simplify Mode Styles */
body.context-aware-simplify {
    background-color: #f9f9f9 !important;
    overflow-x: hidden;
}

/* 
   Target the specific content container we identified 
   to enforce "Reader Mode" typography 
*/
/* Reader View Overlay */
.context-aware-reader-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: #fcfcfc;
    z-index: 2147483647;
    /* Max z-index */
    overflow-y: auto;
    padding: 0;
    margin: 0;
    box-sizing: border-box;
}

/* Toolbar */
.context-aware-reader-toolbar {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: auto;
    min-width: 300px;
    height: auto;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-radius: 50px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 16px;
    box-sizing: border-box;
    z-index: 2147483648;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    animation: toolbarSlideDown 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes toolbarSlideDown {
    from {
        transform: translate(-50%, -100%);
        opacity: 0;
    }

    to {
        transform: translate(-50%, 0);
        opacity: 1;
    }
}

.context-aware-reader-controls {
    display: flex;
    gap: 8px;
    align-items: center;
}

.context-aware-reader-controls button {
    background: transparent;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-family: sans-serif;
    font-size: 16px;
    color: #64748b;
    transition: all 0.2s;
}

.context-aware-reader-controls button:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #0f172a;
    transform: scale(1.1);
}

/* Updated Close Button */
.context-aware-reader-close {
    position: static;
    background: transparent;
    border: none;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    font-size: 20px;
    color: #64748b;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    margin-left: 12px;
}

.context-aware-reader-close:hover {
    color: #ef4444;
    background: rgba(239, 68, 68, 0.1);
    transform: rotate(90deg);
}

/* Content Container Adjustment */
.context-aware-reader-content {
    max-width: 740px;
    /* Slightly narrower for focus */
    margin: 100px auto 60px;
    /* Push down below toolbar */
    padding: 50px;
    background-color: white;
    /* Card look */
    box-shadow: 0 4px 25px rgba(0, 0, 0, 0.05);
    border-radius: 2px;
    min-height: calc(100vh - 160px);

    font-family: 'Georgia', 'Cambria', 'Times New Roman', serif;
    font-size: 20px;
    line-height: 1.6;
    color: #222;
}

/* List handling for Portal Pages (like Google News) */
.context-aware-reader-content ul,
.context-aware-reader-content ol {
    padding-left: 20px;
}

/* If a list item contains only a link, make it look like a story card */
.context-aware-reader-content ul li {
    margin-bottom: 0.8em;
}

.context-aware-reader-content a {
    color: #2c3e50;
    /* Dark blue/grey */
    text-decoration: none;
    border-bottom: 2px solid #e0e0e0;
    transition: border-color 0.2s;
}

.context-aware-reader-content a:hover {
    border-bottom-color: #3498db;
    color: #1a252f;
}

/* Theme: Dark */
.context-aware-reader-overlay.context-aware-theme-dark {
    background-color: #1a1a1a;
}

.context-aware-reader-overlay.context-aware-theme-dark .context-aware-reader-toolbar {
    background: rgba(30, 30, 30, 0.85);
    border-color: rgba(255, 255, 255, 0.1);
}

.context-aware-reader-overlay.context-aware-theme-dark .context-aware-reader-content {
    background-color: #242424;
    color: #dcdcdc;
    box-shadow: none;
}

.context-aware-reader-overlay.context-aware-theme-dark .context-aware-reader-close {
    color: #aaa;
}

.context-aware-reader-overlay.context-aware-theme-dark .context-aware-reader-controls button {
    color: #a3a3a3;
}

.context-aware-reader-overlay.context-aware-theme-dark .context-aware-reader-controls button:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
}

.context-aware-reader-overlay.context-aware-theme-dark .context-aware-reader-content a {
    color: #64b5f6;
    border-bottom-color: #64b5f6;
}

/* Theme: Sepia */
.context-aware-reader-overlay.context-aware-theme-sepia {
    background-color: #f8f1e3;
}

.context-aware-reader-overlay.context-aware-theme-sepia .context-aware-reader-toolbar {
    background: rgba(248, 241, 227, 0.9);
    border-color: rgba(95, 75, 50, 0.1);
}

.context-aware-reader-overlay.context-aware-theme-sepia .context-aware-reader-content {
    background-color: #fbf0d9;
    color: #5f4b32;
    box-shadow: none;
}

.context-aware-reader-overlay.context-aware-theme-sepia .context-aware-reader-controls button {
    color: #5f4b32;
}

.context-aware-reader-overlay.context-aware-theme-sepia .context-aware-reader-controls button:hover {
    background: rgba(95, 75, 50, 0.1);
}

.context-aware-reader-overlay.context-aware-theme-sepia .context-aware-reader-content a {
    color: #8a6d3b;
    border-bottom-color: #8a6d3b;
}

/* Separator styling */
.context-aware-reader-content hr {
    border: 0;
    height: 1px;
    background: #eee;
    margin: 40px 0;
}

/* Enhancements for inner content */
.context-aware-reader-content h1 {
    font-size: 2.4em;
    line-height: 1.2;
    margin-bottom: 0.5em;
    font-family: 'Helvetica Neue', 'Arial', sans-serif;
    letter-spacing: -0.02em;
}

.context-aware-reader-content img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 20px auto;
    border-radius: 4px;
}

.context-aware-reader-meta {
    font-size: 0.9em;
    color: #666;
    margin-bottom: 30px;
    border-bottom: 1px solid #eee;
    padding-bottom: 20px;
}

/* Dark theme overrides for reader content */
body.context-aware-theme-dark .context-aware-simplified-content {
    background-color: #1e1e1e !important;
    color: #e0e0e0 !important;
    box-shadow: none !important;
}

body.context-aware-theme-sepia .context-aware-simplified-content {
    background-color: #fbf0d9 !important;
    color: #5f4b32 !important;
}

/* 
   Since we are NOT cloning, we need to ensure the main content 
   looks "simplified" even in its original place.
   We might need to override some of its parents' styles that might constrain it?
   For now, we just rely on hiding distractions.
*/

/* Focus Mode Styles */
body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    /* Slightly darker for better focus */
    z-index: 9998;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.4s ease-in-out;
}

body.context-aware-focus::after {
    opacity: 1;
    pointer-events: none;
    /* Keep clicks passthrough to underlying elements if needed, but visually dimmed */
}

body.context-aware-focus input,
body.context-aware-focus textarea,
body.context-aware-focus button,
body.context-aware-focus a,
body.context-aware-focus [role="button"],
body.context-aware-focus select {
    position: relative;
    z-index: 9999;
    box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.5), 0 0 20px rgba(59, 130, 246, 0.3);
    /* Cleaner glow */
    background-color: rgba(255, 255, 255, 1);
    transition: box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.2s ease;
    border-radius: 6px;
    outline: none;
    /* Remove default outline as we have custom glow */
}

body.context-aware-focus input:focus,
body.context-aware-focus textarea:focus {
    box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.6), 0 0 30px rgba(59, 130, 246, 0.4);
    transform: scale(1.01);
}


/* Dyslexia Friendly Font Support */
body.context-aware-dyslexia-font,
body.context-aware-dyslexia-font * {
    font-family: 'Comic Sans MS', 'Chalkboard SE', 'Verdana', sans-serif !important;
    line-height: 1.5 !important;
    letter-spacing: 0.05em !important;
}

/* Themes Support */
body.context-aware-theme-dark.context-aware-simplify {
    background-color: #1a1a1a !important;
    color: #e0e0e0 !important;
}

body.context-aware-theme-sepia.context-aware-simplify {
    background-color: #f4ecd8 !important;
    color: #5b4636 !important;
}

/* Ensure controls overlay sits nice everywhere */
/* (Styles removed as they were empty) */

/* Dark mode overrides for focused inputs */
body.context-aware-theme-dark.context-aware-focus input,
body.context-aware-theme-dark.context-aware-focus textarea {
    background-color: #333;
    color: #fff;
    border-color: #3498db;
}

/* Toast Notification for Legacy Mode */
.context-aware-toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.85);
    color: white;
    padding: 12px 24px;
    border-radius: 50px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    font-size: 14px;
    font-weight: 500;
    z-index: 2147483647;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
}

.context-aware-toast.show {
    opacity: 1;
}