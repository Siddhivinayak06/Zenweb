<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ZenWeb</title>
  <link rel="stylesheet" href="sidepanel.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">
</head>

<body>
  <div class="app-container">
    <!-- Minimal Header -->
    <header class="compact-header">
      <div class="logo-area">
        <span class="logo-text">Active</span>
        <div id="connection-status" class="status-dot-mini" title="Connection Status"></div>
      </div>
      <div class="header-actions">
        <div class="brand-logo">ZenWeb</div>
        <button id="btn-settings" class="icon-btn-small" aria-label="Settings">‚öôÔ∏è</button>
      </div>
    </header>

    <!-- Settings Panel (Hidden by default) -->
    <div id="settings-panel" class="settings-panel hidden">
      <div class="settings-header">
        <h2>Settings</h2>
        <button id="btn-close-settings" class="close-btn">√ó</button>
      </div>
      <div class="settings-content">
        <!-- User Account Section -->
        <div id="user-account-section" class="account-card">
          <div id="user-logged-out">
            <p style="margin-bottom: 10px; font-size: 13px;">Sign in to sync settings across devices.</p>
            <div class="auth-buttons" style="display: flex; flex-direction: column; gap: 8px;">
              <input type="email" id="auth-email-input" placeholder="Email" style="width: 100%;">
              <input type="password" id="auth-password-input" placeholder="Password" style="width: 100%;">
              <button id="btn-login" class="action-btn">Sign In</button>
              <div
                style="display: flex; justify-content: space-between; align-items: center; font-size: 11px; margin-top: 4px;">
                <span id="auth-error-msg" style="color: #ef4444;"></span>
                <a href="#" id="btn-toggle-auth-mode" style="color: var(--primary-color);">Need an account? Sign Up</a>
              </div>
            </div>
          </div>
          <div id="user-logged-in" class="hidden">
            <div class="user-info" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
              <img id="user-avatar" src="" alt="Avatar" style="width: 32px; height: 32px; border-radius: 50%;">
              <div>
                <div id="user-name" style="font-weight: 600; font-size: 14px;">User</div>
                <div id="user-plan-badge" class="badge" style="font-size: 10px;">FREE</div>
              </div>
            </div>
            <button id="btn-upgrade-account" class="action-btn"
              style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">Upgrade to Pro</button>
            <button id="btn-logout" class="link-btn"
              style="margin-top: 5px; font-size: 12px; color: var(--text-muted);">Sign Out</button>
          </div>
        </div>
        <hr style="border: 0; border-top: 1px solid var(--border-color); margin: 15px 0;">

        <label for="api-key-input">Gemini API Key</label>
        <input type="password" id="api-key-input" placeholder="Paste your API key here">
        <label for="voice-select">Reading Voice</label>
        <select id="voice-select" class="settings-select">
          <option value="auto">Auto (Best Match)</option>
        </select>

        <!-- Pro Upsell: Visual Difference -->
        <div class="setting-row disabled-row" title="Available in Pro Tier">
          <span>Sync to Mobile <span class="badge"
              style="font-size: 8px; vertical-align: middle; background: #6366f1;">PRO</span></span>
          <label class="toggle-switch small">
            <input type="checkbox" disabled>
            <span class="slider"></span>
          </label>
        </div>

        <button id="btn-save-settings" class="action-btn">Save Settings</button>
        <div id="settings-status" class="status-msg"></div>
      </div>
    </div>

    <!-- Action Items Panel (Pro) -->
    <div id="action-panel" class="settings-panel hidden">
      <div class="settings-header">
        <h2>Action Items <span class="badge" style="background:#6366f1">PRO</span></h2>
        <button id="btn-close-actions" class="close-btn">√ó</button>
      </div>
      <div class="settings-content" id="action-list-container" style="flex: 1; overflow-y: auto;">
        <!-- Content injected by JS -->
      </div>
      <div class="pro-actions-footer"
        style="padding-top: 10px; border-top: 1px solid var(--border-color); display: flex; gap: 8px;">
        <button id="btn-copy-actions" class="action-btn" style="flex:1">Copy Text</button>
        <button id="btn-export-actions" class="action-btn" style="flex:1; background: #1e293b;">Export ‚Üó</button>
      </div>
    </div>



    <!-- Main Content -->
    <main class="main-content">

      <!-- Cognitive Score (Compact Card) -->
      <div class="context-card" id="score-strip">
        <div class="score-left">
          <span class="score-emoji" id="score-emoji">‚è≥</span>
          <span class="score-value" id="score-value">--</span>
        </div>
        <div class="score-right">
          <span class="score-label" id="score-label">Page Load Score</span>
          <button id="btn-refresh-score" class="icon-btn-text" title="Refresh">‚Üª</button>
        </div>
      </div>

      <!-- Quick Actions Grid -->
      <div class="quick-actions">
        <button id="btn-simplify" class="quick-btn" data-mode="simplify">
          <span class="quick-icon">üìñ</span>
          <span class="quick-label">Simplify</span>
        </button>
        <button id="btn-focus" class="quick-btn" data-mode="focus">
          <span class="quick-icon">üéØ</span>
          <span class="quick-label">Focus</span>
        </button>
        <button id="btn-summarize" class="quick-btn">
          <span class="quick-icon">‚ú®</span>
          <span class="quick-label">Summarize</span>
        </button>
        <button id="btn-actions" class="quick-btn">
          <span class="quick-icon">‚òëÔ∏è</span>
          <span class="quick-label">Actions</span>
        </button>
        <button id="btn-pause" class="quick-btn">
          <span class="quick-icon">‚è∏Ô∏è</span>
          <span class="quick-label">Pause</span>
        </button>
        <button id="btn-reset" class="quick-btn reset">
          <span class="quick-icon">‚Ü∫</span>
          <span class="quick-label">Reset</span>
        </button>
      </div>


      <!-- Collapsible Sections -->
      <div class="collapsible-sections">

        <!-- Profiles Section -->
        <div class="profile-section-container">
          <div class="profile-header-row">
            <span class="section-label">Cognitive Mode</span>
            <button id="btn-clear-profile" class="link-btn-small">‚úï Clear</button>
          </div>
          <div class="profile-grid" id="profile-selector">
            <button class="profile-chip" data-profile="adhd" title="ADHD Focus">‚óè ADHD</button>
            <button class="profile-chip" data-profile="dyslexia" title="Dyslexia Friendly">‚óã Dyslexia</button>
            <button class="profile-chip" data-profile="lowVision" title="Low Vision">‚óã Low Vision</button>
            <button class="profile-chip" data-profile="sensory" title="Sensory Calm">‚óã Sensory</button>
            <button class="profile-chip" data-profile="custom" title="Custom">‚óã Custom</button>
          </div>

          <!-- Custom editor hidden by default -->
          <div id="custom-profile-editor" class="custom-profile-editor hidden">
            <!-- Editor content same as before -->
          </div>
          <button id="btn-edit-custom-profile" class="link-btn hidden" style="margin-top: 8px;">Configure
            Custom</button>
        </div>

        <!-- Tools List -->
        <div class="tools-list">
          <!-- Chat -->
          <details class="tool-item">
            <summary class="tool-header">
              <span class="tool-icon">üí¨</span>
              <span class="tool-title">Chat with Page</span>
              <span class="tool-arrow">‚Ä∫</span>
            </summary>
            <div class="tool-content chat-content">
              <div id="chat-messages" class="chat-messages-compact">
                <div class="chat-placeholder">Ask anything about this page...</div>
              </div>
              <div class="chat-input-row">
                <input type="text" id="chat-input" placeholder="Type a question..." />
                <button id="btn-send-chat" class="send-btn-compact">‚û§</button>
              </div>
            </div>
          </details>

          <!-- Appearance -->
          <details class="tool-item">
            <summary class="tool-header">
              <span class="tool-icon">üé®</span>
              <span class="tool-title">Appearance</span>
              <span class="tool-arrow">‚Ä∫</span>
            </summary>
            <div class="tool-content">
              <div class="setting-row">
                <span>Dyslexia Font</span>
                <label class="toggle-switch small">
                  <input type="checkbox" id="check-dyslexia">
                  <span class="slider"></span>
                </label>
              </div>
              <div class="setting-row">
                <span>Bionic Reading</span>
                <label class="toggle-switch small">
                  <input type="checkbox" id="check-bionic">
                  <span class="slider"></span>
                </label>
              </div>
              <div class="setting-row">
                <span>Block Ads</span>
                <label class="toggle-switch small">
                  <input type="checkbox" id="check-adblocker" checked>
                  <span class="slider"></span>
                </label>
              </div>
              <div class="theme-row">
                <button class="theme-chip" data-theme="light">‚òÄÔ∏è Light</button>
                <button class="theme-chip" data-theme="sepia">‚òï Sepia</button>
                <button class="theme-chip" data-theme="dark">üåô Dark</button>
              </div>
            </div>
          </details>

          <!-- Summary -->
          <details class="tool-item" id="summary-section">
            <summary class="tool-header">
              <span class="tool-icon">üìù</span>
              <span class="tool-title">AI Summary</span>
              <span class="tool-arrow">‚Ä∫</span>
            </summary>
            <div class="tool-content">
              <div id="summary-container" class="summary-compact">
                <p class="summary-placeholder">Click "Summarize" above to analyze this page</p>
              </div>
              <div class="summary-actions hidden" id="summary-actions">
                <button id="btn-copy-summary" class="action-link">üìã Copy</button>
                <button id="btn-clear-summary" class="action-link">üóëÔ∏è Clear</button>
              </div>
            </div>
          </details>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="compact-footer">
      <button id="btn-dashboard" class="footer-link-clean">üìä Open Analytics Dashboard</button>
    </footer>
  </div>

  <!-- Hidden elements for status tracking -->
  <div id="live-stats" class="hidden">
    <span id="distraction-count">0</span>
    <span id="active-mode">None</span>
  </div>

  <script type="module" src="sidepanel.js"></script>
</body>

</html>